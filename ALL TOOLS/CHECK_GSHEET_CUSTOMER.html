<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; padding: 20px; }
  h2 { text-align:center; color:#333; }
  .container { display:flex; flex-wrap:wrap; gap:40px; }
  .left, .right { flex:1; min-width:300px; }
  textarea { width:100%; height:200px; padding:10px; font-size:14px; border-radius:8px; }
  select, button { padding:10px; margin-top:10px; font-size:14px; }
  table { width:100%; border-collapse: collapse; margin-top:10px; }
  th { background:#1976d2; color:white; padding:8px; text-align:left; }
  td { padding:8px; border-bottom:1px solid #ddd; }
  tr.match td { background:#c8e6c9; }
  tr.no-match td { background:#ffcdd2; }
</style>
</head>
<body>

<h2>WEBSITE ORDER CUSTOMER NAME CHECKER TESTING</h2>
<div class="container">
  <!-- Left panel -->
  <div class="left">
    <h3>Select Page</h3>
    <select id="pageSelect"></select>
    <h3>Paste Website Names to Check Here!</h3>
    <textarea id="input" placeholder="One name per line"></textarea>
    <button onclick="processData()">CHECK</button>
  </div>

  <!-- Right panel -->
  <div class="right">
    <h3>Results</h3>
    <div id="output">Waiting for input...</div>
  </div>
</div>

<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwxV3WrsZoUCd6HcYYI3Fw_MSAJzAtHqmmbdu55pMtS3m_nJMjg254pd-FnMjrxt5C_1g/exec"; // paste your deployed web app URL here
let sheetData = [];

// fetch sheet data
fetch(WEB_APP_URL)
  .then(res => res.json())
  .then(data => {
      sheetData = data;
      populateDropdown();
  })
  .catch(err => document.getElementById("output").innerText = "Error fetching sheet data.");

// populate page dropdown
function populateDropdown() {
    const select = document.getElementById("pageSelect");
    const pages = sheetData[0]; // first row = page names
    pages.forEach((p, idx) => {
        if(p) {
            const option = document.createElement("option");
            option.value = idx;
            option.textContent = p;
            select.appendChild(option);
        }
    });
}

function processData() {
    const raw = document.getElementById("input").value.trim();
    if(!raw) {
        document.getElementById("output").innerHTML = "No names pasted.";
        return;
    }

    const selectedIndex = document.getElementById("pageSelect").value;
    if(selectedIndex === "") {
        document.getElementById("output").innerHTML = "Please select a page.";
        return;
    }

    const namesToCheck = raw.split("\n").map(n => n.trim()).filter(n => n !== "");
    const colIndex = parseInt(selectedIndex); 
    const pageNames = sheetData.slice(1).map(r => r[colIndex]).filter(n => n); // names under selected page

    let html = "<table><tr><th>Name</th><th>Status</th></tr>";
    namesToCheck.forEach(name => {
        const match = pageNames.some(n => n.toLowerCase() === name.toLowerCase());
        html += `<tr class="${match?'match':'no-match'}"><td>${name}</td><td>${match ? 'MATCH ✔':'NO NAME IN GSHEET ✖'}</td></tr>`;
    });
    html += "</table>";

    document.getElementById("output").innerHTML = html;
}
</script>

</body>
</html>


