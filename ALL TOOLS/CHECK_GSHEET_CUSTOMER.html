<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  /* ===== BODY ===== */
  body {
    font-family: 'Segoe UI', sans-serif;
    background: #f0f2f5;
    margin: 0;
    padding: 20px 40px 20px 60px; /* larger left margin */
  }
  h2 { 
    text-align:center; 
    color:#333; 
    margin-bottom: 30px;
  }

  /* ===== CONTAINER ===== */
  .container { 
    display: flex; 
    flex-wrap: wrap; 
    gap: 40px; 
  }

  .left, .right { 
    flex: 1; 
    min-width: 300px; 
    background: #fff; 
    padding: 20px; 
    border-radius: 12px; 
    box-shadow: 0 4px 12px rgba(0,0,0,0.08); 
    box-sizing: border-box;
  }

  h3 { 
    margin-top: 0; 
    margin-bottom: 12px; 
    color: #1976d2; 
  }

  /* ===== TEXTAREAS & SELECT ===== */
  textarea, select { 
    width: 100%; 
    padding: 12px; 
    font-size: 14px; 
    border-radius: 8px; 
    border: 1px solid #ccc; 
    box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
    resize: none;
    display: block;
    box-sizing: border-box;
    margin-bottom: 12px;
  }

  select { cursor: pointer; }

  /* ===== BUTTON ===== */
  button { 
    padding: 12px 24px; 
    font-size: 14px; 
    border: none; 
    border-radius: 8px; 
    background: #1976d2; 
    color: white; 
    cursor: pointer; 
    transition: background 0.3s, transform 0.2s;
    display: block;
  }
  button:hover { 
    background: #1565c0; 
    transform: translateY(-2px);
  }

  /* ===== TABLE ===== */
  table { 
    width: 100%; 
    border-collapse: collapse; 
    margin-top: 15px; 
    border-radius: 8px; 
    overflow: hidden; 
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
  }

  th { 
    background:#1976d2; 
    color:white; 
    padding:10px; 
    text-align:left; 
    font-size: 14px;
  }
  td { 
    padding:10px; 
    border-bottom:1px solid #eee; 
    font-size: 13px;
    transition: background 0.3s;
  }

  tr.match td { background:#c8e6c9; }
  tr.no-match td { background:#ffcdd2; }
  tr:hover td { background: #f1f1f1; }

  /* ===== RESPONSIVE ===== */
  @media (max-width: 800px) { 
    .container { flex-direction: column; } 
  }
</style>
</head>
<body>

<h2>WEBSITE ORDER CUSTOMER NAME CHECKER</h2>

<div class="container">
  <!-- Left panel -->
  <div class="left">
    <h3>Select Page</h3>
    <select id="pageSelect"></select>

    <h3>Paste Website Names to Check</h3>
    <textarea id="input" placeholder="One name per line"></textarea>
    <button onclick="processData()">CHECK</button>
  </div>

  <!-- Right panel -->
  <div class="right">
    <h3>Results</h3>
    <div id="output">Waiting for input...</div>
  </div>
</div>

<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwxV3WrsZoUCd6HcYYI3Fw_MSAJzAtHqmmbdu55pMtS3m_nJMjg254pd-FnMjrxt5C_1g/exec";
let sheetData = [];

// fetch sheet data
fetch(WEB_APP_URL)
  .then(res => res.json())
  .then(data => {
      sheetData = data;
      populateDropdown();
  })
  .catch(err => document.getElementById("output").innerText = "Error fetching sheet data.");

// populate page dropdown
function populateDropdown() {
    const select = document.getElementById("pageSelect");
    const pages = sheetData[0]; // first row = page names
    pages.forEach((p, idx) => {
        if(p) {
            const option = document.createElement("option");
            option.value = idx;
            option.textContent = p;
            select.appendChild(option);
        }
    });
}

function processData() {
    const raw = document.getElementById("input").value.trim();
    if(!raw) {
        document.getElementById("output").innerHTML = "No names pasted.";
        return;
    }

    const selectedIndex = document.getElementById("pageSelect").value;
    if(selectedIndex === "") {
        document.getElementById("output").innerHTML = "Please select a page.";
        return;
    }

    const namesToCheck = raw.split("\n").map(n => n.trim()).filter(n => n !== "");
    const colIndex = parseInt(selectedIndex); 
    const pageNames = sheetData.slice(1).map(r => r[colIndex]).filter(n => n); // names under selected page

    let html = "<table><tr><th>Name</th><th>Status</th></tr>";
    namesToCheck.forEach(name => {
        const match = pageNames.some(n => n.toLowerCase() === name.toLowerCase());
        html += `<tr class="${match?'match':'no-match'}"><td>${name}</td><td>${match ? 'MATCH ✔':'NO NAME IN GSHEET ✖'}</td></tr>`;
    });
    html += "</table>";

    document.getElementById("output").innerHTML = html;
}
</script>

</body>
</html>

